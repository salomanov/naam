import{i as m}from"./app.min.js";class v{constructor(t){let o={init:!0,logging:!0};if(this.config=Object.assign(o,t),this.config.init){const n=document.querySelectorAll("[data-fls-beforeafter]");n.length>0?(this.setLogging(`Проснулся, вижу элементы: ${n.length}`),this.beforeAfterInit(n)):this.setLogging("Проснулся, не вижу элементов")}}beforeAfterInit(t){t.forEach(o=>{o&&(this.beforeAfterClasses(o),this.beforeAfterItemInit(o))})}beforeAfterClasses(t){t.querySelector("[data-fls-beforeafter-arrow]"),t.addEventListener("mouseover",function(o){const n=o.target;n.hasAttribute("data-fls-beforeafter-arrow")||(n.closest("[data-fls-beforeafter-before]")?(t.classList.remove("-right"),t.classList.add("-left")):(t.classList.add("-right"),t.classList.remove("-left")))}),t.addEventListener("mouseleave",function(){t.classList.remove("-left"),t.classList.remove("-right")})}beforeAfterItemInit(t){const o=t.querySelector("[data-fls-beforeafter-arrow]"),n=t.querySelector("[data-fls-beforeafter-after]"),l=parseFloat(window.getComputedStyle(o).getPropertyValue("width"));let s={};o&&(m.any()?o.addEventListener("touchstart",i):o.addEventListener("mousedown",i));function i(p){s={width:t.offsetWidth,left:t.getBoundingClientRect().left-scrollX},m.any()?(document.addEventListener("touchmove",r),document.addEventListener("touchend",function(f){document.removeEventListener("touchmove",r)},{once:!0})):(document.addEventListener("mousemove",r),document.addEventListener("mouseup",function(f){document.removeEventListener("mousemove",r)},{once:!0})),document.addEventListener("dragstart",function(f){f.preventDefault()},{once:!0})}function r(p){const f=p.type==="touchmove"?p.touches[0].clientX-s.left:p.clientX-s.left;if(f<=s.width&&f>0){const d=f/s.width*100;o.style.cssText=`left:calc(${d}% - ${l}px)`,n.style.cssText=`width: ${100-d}%`}else f>=s.width?(o.style.cssText=`left: calc(100% - ${l}px)`,n.style.cssText="width: 0%"):f<=0&&(o.style.cssText="left: 0%",n.style.cssText="width: 100%")}}setLogging(t){this.config.logging}}new v({});document.addEventListener("DOMContentLoaded",function(){S()});function S(){typeof window.flsPopup<"u"?(console.log("Popup system loaded, using module system"),g()):(console.log("Popup system not loaded, initializing fallback"),setTimeout(()=>{typeof window.flsPopup>"u"?L():g()},1e3)),window.setPopupContent=function(t){const o=t.closest(".blog__post");if(!o)return;const n={beforeImg:o.querySelector("[data-fls-beforeafter-before] img")?.src,afterImg:o.querySelector("[data-fls-beforeafter-after] img")?.src,title:o.querySelector(".post__title")?.textContent,content:o.querySelector(".post__content")?.innerHTML,category:o.getAttribute("data-category")};window.popupContentData=n,typeof window.flsPopup>"u"&&u()}}function g(){document.addEventListener("beforePopupOpen",function(e){e.detail.popup.targetOpen.selector==="popup_blog"&&_()}),document.addEventListener("afterPopupClose",function(e){e.detail.popup.targetOpen.selector==="popup_blog"&&b()}),document.addEventListener("afterPopupOpen",function(e){e.detail.popup.targetOpen.selector==="popup_blog"&&setTimeout(()=>{w()},300)})}function _(e){const t=window.popupContentData;if(!t){console.warn("No popup content data found");const o=document.activeElement;if(o&&o.classList.contains("post__link")){const n=o.closest(".blog__post");if(n){window.popupContentData={beforeImg:n.querySelector("[data-fls-beforeafter-before] img")?.src,afterImg:n.querySelector("[data-fls-beforeafter-after] img")?.src,title:n.querySelector(".post__title")?.textContent,content:n.querySelector(".post__content")?.innerHTML},a(window.popupContentData),c();return}}return}a(t),c()}function a(e){const t=document.querySelector('[data-fls-popup="popup_blog"]');if(!t)return;const o=t.querySelector("[data-fls-beforeafter-before] img"),n=t.querySelector("[data-fls-beforeafter-after] img"),l=t.querySelector(".post__title"),s=t.querySelector(".post__content"),i=t.querySelector("[data-fls-beforeafter-after]"),r=t.querySelector("[data-fls-beforeafter]"),p=t.querySelector("[data-fls-beforeafter-arrow]");i&&(i.style.display=""),p&&(p.style.visibility="",p.style.display=""),r&&r.classList.remove("no-after"),o&&e.beforeImg&&(o.src=e.beforeImg,o.alt=e.title+" - до"),n&&e.afterImg?(n.src=e.afterImg,n.alt=e.title+" - после"):(i&&(i.style.display="none"),p&&(p.style.visibility="hidden",p.style.display="none"),r&&r.classList.add("no-after")),l&&e.title&&(l.textContent=e.title),s&&e.content&&(s.innerHTML=e.content)}function c(){setTimeout(()=>{typeof window.flsBeforeAfter<"u"&&document.querySelectorAll('[data-fls-popup="popup_blog"] [data-fls-beforeafter]').forEach(t=>{t.removeAttribute("style");const o=t.querySelector("[data-fls-beforeafter-arrow]");o&&o.removeAttribute("style"),window.flsBeforeAfter.initBeforeAfterElement(t)})},100)}function b(){window.popupContentData=null;const e=document.querySelector('[data-fls-popup="popup_blog"]');if(!e)return;const t=e.querySelector("[data-fls-beforeafter-before] img"),o=e.querySelector("[data-fls-beforeafter-after] img"),n=e.querySelector(".post__title"),l=e.querySelector(".post__content"),s=e.querySelector("[data-fls-beforeafter-after]"),i=e.querySelector("[data-fls-beforeafter]"),r=e.querySelector("[data-fls-beforeafter-arrow]");t&&(t.src=""),o&&(o.src=""),n&&(n.textContent=""),l&&(l.innerHTML=""),s&&(s.style.display=""),r&&(r.style.visibility="",r.style.display=""),i&&i.classList.remove("no-after")}function w(){const e=document.querySelector('[data-fls-popup="popup_blog"]');if(!e)return;const o=[e.querySelector("[data-fls-popup-content]"),e.querySelector("[data-fls-popup-body]"),e.querySelector("[data-fls-popup-wrapper]"),e].filter(n=>n!==null).find(n=>{const l=getComputedStyle(n);return(l.overflowY==="auto"||l.overflowY==="scroll")&&n.scrollHeight>n.clientHeight});o&&(o.scrollTop=0,setTimeout(()=>{o.scrollTop!==0&&(o.scrollTop=0)},50),setTimeout(()=>{o.scrollTop!==0&&(o.scrollTop=0,o.scrollTo({top:0,behavior:"smooth"}))},100))}function L(){console.log("Initializing Safari-compatible popup fallback"),document.addEventListener("click",function(e){if(e.target.classList.contains("post__link")||e.target.closest(".post__link")){e.preventDefault();const t=e.target.classList.contains("post__link")?e.target:e.target.closest(".post__link");window.setPopupContent(t),u()}(e.target.closest("[data-fls-popup-close]")||e.target.closest("[data-fls-popup]")&&!e.target.closest("[data-fls-popup-body]"))&&y()}),document.addEventListener("keydown",function(e){e.key==="Escape"&&y()})}function u(){const e=document.querySelector('[data-fls-popup="popup_blog"]');if(!e)return;const t=window.popupContentData;t&&a(t),e.offsetHeight,e.setAttribute("data-fls-popup-active",""),document.documentElement.setAttribute("data-fls-popup-open",""),document.body.style.overflow="hidden",c(),setTimeout(()=>{w()},50)}function y(){const e=document.querySelector('[data-fls-popup="popup_blog"][data-fls-popup-active]');e&&(e.removeAttribute("data-fls-popup-active"),document.documentElement.removeAttribute("data-fls-popup-open"),document.body.style.overflow="",b())}document.addEventListener("click",function(e){const t=e.target.closest('[data-fls-popup-link="popup_blog"][data-fls-popup-source]');if(t){e.preventDefault();const o=t.getAttribute("data-fls-popup-source"),n=t.closest(o);n&&(window.popupContentData={beforeImg:n.querySelector("[data-fls-beforeafter-before] img")?.src,afterImg:n.querySelector("[data-fls-beforeafter-after] img")?.src,title:n.querySelector(".post__title")?.textContent,content:n.querySelector(".post__content")?.innerHTML},typeof window.flsPopup<"u"?window.flsPopup.open("popup_blog"):u())}});
